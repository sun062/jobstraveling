<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>새 진로 프로그램 등록</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8f9fa; }
        .form-container { max-width: 800px; margin: 0 auto; padding: 20px; background-color: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); }
        .input-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; }
        .input-group input, .input-group select, .input-group textarea {
            width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; transition: border-color 0.3s;
        }
        .input-group input:focus, .input-group select:focus, .input-group textarea:focus { border-color: #3b82f6; outline: none; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3); }
        .required::after { content: '*'; color: #ef4444; margin-left: 4px; }
    </style>
    <!-- Streamlit Component API 로드 -->
    <script src="https://cdn.jsdelivr.net/npm/@streamlit/lib@0.2.3/dist/streamlit-component-lib.js"></script>
</head>
<body>
    <div class="form-container">
        <!-- oninput 이벤트로 데이터가 변경될 때마다 Streamlit으로 전송 -->
        <form id="program-form" oninput="sendDataToStreamlit()" onsubmit="event.preventDefault(); return false;">
            <div class="space-y-6">
                
                <!-- 프로그램명 (필수) -->
                <div class="input-group">
                    <label for="title" class="required">프로그램명</label>
                    <input type="text" id="title" placeholder="예: 구글 개발자 캠프" required>
                </div>

                <!-- 직업 분야 (필수) -->
                <div class="input-group">
                    <label for="field" class="required">관련 직업/분야</label>
                    <input type="text" id="field" placeholder="예: IT/개발, 환경 과학, 디자인" required>
                </div>

                <!-- 위치 및 주최 -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="input-group">
                        <label for="location" class="required">장소/진행 방식</label>
                        <input type="text" id="location" placeholder="예: 서울 코엑스, 온라인, 전국" required>
                    </div>

                    <div class="input-group">
                        <label for="host" class="required">주최/운영 기관</label>
                        <input type="text" id="host" placeholder="예: 교육부, 삼성전자, 청소년재단" required>
                    </div>
                </div>

                <!-- 모집 상태 (필수) -->
                <div class="input-group">
                    <label for="status" class="required">현재 모집 상태</label>
                    <select id="status" required>
                        <option value="">선택하세요</option>
                        <option value="모집 중">모집 중</option>
                        <option value="모집 예정">모집 예정</option>
                        <option value="모집 마감">모집 마감</option>
                        <option value="종료">종료</option>
                    </select>
                </div>

                <!-- 상세 설명 -->
                <div class="input-group">
                    <label for="description">상세 설명</label>
                    <textarea id="description" rows="5" placeholder="프로그램의 목표, 주요 내용, 대상 등을 자세히 설명해 주세요."></textarea>
                </div>
                
                <!-- 참고 링크 -->
                <div class="input-group">
                    <label for="link">참고 링크 (선택)</label>
                    <input type="url" id="link" placeholder="예: https://program.com/detail">
                </div>
            </div>
        </form>
    </div>

    <script>
        /**
         * 폼 데이터를 수집하고 Streamlit Python으로 전송하는 함수
         */
        function sendDataToStreamlit() {
            if (typeof Streamlit === 'undefined') {
                console.error("Streamlit is not defined. Skipping data send.");
                return;
            }

            // 1. 데이터 수집
            const programData = {
                title: document.getElementById('title').value.trim(),
                field: document.getElementById('field').value.trim(),
                location: document.getElementById('location').value.trim(),
                host: document.getElementById('host').value.trim(),
                status: document.getElementById('status').value,
                description: document.getElementById('description').value.trim(),
                link: document.getElementById('link').value.trim(),
            };

            // 2. Streamlit Python 컴포넌트로 데이터 전송
            // 모든 필수 항목이 채워지지 않았더라도, 현재의 모든 데이터를 전송하여
            // Python 측에서 항상 최신(채워진) 데이터를 받을 수 있도록 합니다.
            Streamlit.setComponentValue({ 
                programData: programData
            });
            
            Streamlit.setFrameHeight();
        }

        /**
         * Streamlit 객체가 로드될 때까지 기다렸다가 sendDataToStreamlit을 호출하는 함수
         */
        function initializeComponent() {
            const checkStreamlit = setInterval(() => {
                if (typeof Streamlit !== 'undefined') {
                    clearInterval(checkStreamlit);
                    
                    // 컴포넌트 초기화 완료 후, 초기 값을 Python으로 한 번 전송 (필수)
                    sendDataToStreamlit(); 
                }
            }, 50); // 50ms 간격으로 확인
        }

        // 3. 페이지 로드 완료 시 컴포넌트 초기화 시작
        window.onload = initializeComponent;
    </script>
</body>
</html>
